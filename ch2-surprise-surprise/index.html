
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>Chapter 2 - The-Heist</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-2-surprise-surprise" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="The-Heist" class="md-header__button md-logo" aria-label="The-Heist" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            The-Heist
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 2
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="The-Heist" class="md-nav__button md-logo" aria-label="The-Heist" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    The-Heist
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Game Briefing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ch1-open-briefcase/" class="md-nav__link">
        Chapter 1
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Chapter 2
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#briefing" class="md-nav__link">
    Briefing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-nfc-reader-wiring" class="md-nav__link">
    Step 1 - NFC Reader Wiring
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-find-the-right-info-write-it-on-the-nfc-card-open-the-safe" class="md-nav__link">
    Step 2 - Find the right info, write it on the NFC-card, open the safe
  </a>
  
    <nav class="md-nav" aria-label="Step 2 - Find the right info, write it on the NFC-card, open the safe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#about-the-medusa-network" class="md-nav__link">
    About the MEDUSA network
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#understanding-all-data-stored-on-the-badge" class="md-nav__link">
    Understanding all data stored on the badge
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#becoming-sc-4" class="md-nav__link">
    Becoming SC 4
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#briefing" class="md-nav__link">
    Briefing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-1-nfc-reader-wiring" class="md-nav__link">
    Step 1 - NFC Reader Wiring
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-find-the-right-info-write-it-on-the-nfc-card-open-the-safe" class="md-nav__link">
    Step 2 - Find the right info, write it on the NFC-card, open the safe
  </a>
  
    <nav class="md-nav" aria-label="Step 2 - Find the right info, write it on the NFC-card, open the safe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#about-the-medusa-network" class="md-nav__link">
    About the MEDUSA network
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#understanding-all-data-stored-on-the-badge" class="md-nav__link">
    Understanding all data stored on the badge
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#becoming-sc-4" class="md-nav__link">
    Becoming SC 4
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="chapter-2-surprise-surprise">Chapter 2: Surprise Surprise</h1>
<h2 id="briefing">Briefing</h2>
<p>Congratulations, you managed to open the briefcase.
Inside will be lots of documents, some interesting, some completely useless.
Ohh wait. There's a badge! Quick, hurry-up and try to login onto the safe...<br />
What? It didn't work?... Hmmm.</p>
<p>Damn! The intel was wrong. The employee whose briefcase was stolen is only a SC 3...</p>
<p>Remember, you need to be Security Clearance level 4 or above in order to get access to the content of the safe.</p>
<p>You'll need to find another way.</p>
<h2 id="step-1-nfc-reader-wiring">Step 1 - NFC Reader Wiring</h2>
<p>The employee badge is a MiFARE Classic 1K card. Your first job is to wire the NFC-Reader (PN-532) to the Arduino and make it able to detect the card.</p>
<p>Just so you know, the Arduino uses a SPI Connection in order to communicate with the reader.</p>
<p><strong>Hint:</strong> Everything should be written on the card itself, if you can't read it well, look into the Datasheet in your docs ;)</p>
<h2 id="step-2-find-the-right-info-write-it-on-the-nfc-card-open-the-safe">Step 2 - Find the right info, write it on the NFC-card, open the safe</h2>
<h3 id="about-the-medusa-network">About the MEDUSA network</h3>
<p>The auth network is available on a wireless connection, with a hidden SSID.</p>
<p>By scanning the available WiFi Networks with <strong>airmon-ng</strong>, we can easily determine which one it is.</p>
<p>Then, using <strong>aircrack-ng</strong> or <strong>wifite</strong> or any cracking software, we managed to crack it!</p>
<p>Great: here are the credentials:</p>
<p><code>SSID: MEDUSA</code>
<code>Key: E0E9542D44</code></p>
<p>After sniffing around, we found ARP requests going to <code>192.168.1.2</code>... Could this be our auth server?</p>
<p>A quick portscan indicates ports <code>80</code> and <code>8080</code> are both listening on that IP... Seems that we're onto something.</p>
<p>Why don't you go check with your browser what's on <code>http://192.168.1.2</code></p>
<p>Don't forget we're looking for someone with SC 4 and above...</p>
<p><strong>Hint: Now may be the time to take a look on all those files in your briefcase...</strong></p>
<p><strong>Hint 2 : You may need to use a tool to convert some data... visit <em>"/tools"</em> page of the website</strong></p>
<h3 id="understanding-all-data-stored-on-the-badge">Understanding all data stored on the badge</h3>
<p>We have taught you to understand the data stored on the badge.</p>
<p>You understand how memory is organized and how TLV payloads are encoded.
(if you don't remember, we have provided you with the official documentation of MiFARE!)</p>
<p>What could help is to understand how data is encoded on the card.</p>
<p><strong>Remember:</strong> Only the Employee UUID and Last Login Timestamp are to be changed.</p>
<p>For reference :
 * a UUID is encoded on 16-bytes, 2 characters per byte (should not require any specific encoding)
 * a String encoded in ASCII takes only one byte per character
 * a Timestamp can be encoded on 4 or 8 bytes. Timestamp of 4 bytes for <strong>January 1st 2020 12:00 AM</strong> is <strong>0x5E0BD2F0</strong> in Hex, <strong>1577833200</strong> in decimal (epoch seconds)</p>
<p>In our case, you can consider that the timestamp is written as <strong>little-endian</strong>.</p>
<h3 id="becoming-sc-4">Becoming SC 4</h3>
<p>If you found the right data by hacking on the website, and understood which blocks you should change on sector 3, you only need to manually write the blocks using your microcontroller interface.</p>
<p>The command should be <strong>nfc-write</strong>, don't forget to initialize the NFC Reader by using the <strong>nfc-en</strong> command</p>
<p>Let's crack this safe!</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../ch1-open-briefcase/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 1" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 1
            </div>
          </div>
        </a>
      
      
        
        <a href="../about/" class="md-footer__link md-footer__link--next" aria-label="Next: About" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              About
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.1e84347e.min.js"></script>
      
    
  </body>
</html>